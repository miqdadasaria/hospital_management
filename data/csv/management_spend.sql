SELECT  nm.ORG_CODE, nm.AFC_BAND, N, N*AVERAGE FROM
(SELECT ORG_CODE FROM provider WHERE upper(ORG_TYPE)="ACUTE") p
INNER JOIN
(SELECT ORG_CODE, count(*) AS N, AFC_BAND FROM non_medical_staff WHERE upper(LEVEL) LIKE '%MANAGER%' GROUP BY AFC_BAND, ORG_CODE) nm
ON p.ORG_CODE = nm.ORG_CODE
LEFT JOIN
(SELECT AFC_BAND, AVERAGE FROM pay_scale WHERE YEAR=2017) ps
ON nm.AFC_BAND = ps.AFC_BAND
ORDER BY nm.ORG_CODE, nm.AFC_BAND;